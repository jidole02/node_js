# node.js 기초 - 1

- 포트 죽이기 ( netstat -ano | find "LISTENING" | find "3000" , taskkill /F /PID 3792 )
- ... is not a constructor = 생성자가 아니다,,, ㅋㅋㅋㅋ

## express

- 시작 : npm init -> npm i express
- 

## require, exports

- require는 nodeJS에서 다른 패키지를 불러올 때 사용되는 키워드

  ```javascript
  const user = require("../controller/user")
  ```

## process.env

- process.env는 nodeJS에서 환경 변수를 가져올 때 사용, 환경 변수가 입력되지 않을 시 port에 3000번을 지정하는 코드

```javascript
const port = process.env.PORT || 3000;
```



## router

- CRUD ( Rest API )

     CREATE : post

     READ : get

     UPDATE : put

     DELETE : delete

- router.js 의 기능  - 리액트의 App.js 와 비슷하다. 만든 서버 모듈을 불러와서 작동시킴

  ```javascript
  const express = require('express');
  const route = express.Router();
  const user = require("../controller/user")
  
  route.route('/user')
      .post(user.createUser)
      .get(user.readUser)
      .put(user.updateUser)
      .delete(user.deleteUser);
  
  module.exports = route;
  ```

## passport 

- 세션을 내부적으로 처리해준다. 

- 세션이란? 

  -일정 시간동안 같은 사용자(브라우저)로부터 들어오는
  일련의 요구를 하나의 상태로 보고, 그 상태를 일정하게 유지시키는 기술이다.

  출처: https://hahahoho5915.tistory.com/32 [넌 잘하고 있어]

```javascript
var BaisicStrategy = require('passport-http').BasicStrategy
```

- passport 의 strategy 생성자는 어떤 로그인 방식을 취해야 하는지 알려줌'

## 기본적인 로그인 로직

```javascript
var passport = require('passport')
  , LocalStrategy = require('passport-local').Strategy;

passport.use(new LocalStrategy({
  usernameField: 'email',
  passwordField: 'passwd'
  },
  function(username, password, done) {
    User.findOne({ username: username }, function(err, user) { // 이부분이 디비 내용 가져오는거        
      if (err) { return done(err); }                                         
      if (!user) {                                                       
        return done(null, false, { message: 'Incorrect username.' });
      }
      if (!user.validPassword(password)) {
        return done(null, false, { message: 'Incorrect password.' });         
      }
      return done(null, user);                                              
    });
  }
));
```

